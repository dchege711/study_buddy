var AppUtilities;(()=>{"use strict";var e,t={};(e=t).sendForm=function(t,n){return new Promise((function(s,r){let i=document.forms[t];if(i.checkValidity()){let t=i.elements,o={};for(let e=0;e<t.length;e++)"checkbox"==t[e].type?o[t[e].name]=t[e].checked:o[t[e].name]=t[e].value;delete o[""],e.sendHTTPRequest("POST",n,o).then((e=>{s(e)})).catch((e=>{r(e)}))}else i.reportValidity(),r("Please fill in the form with valid inputs.")}))},e.sendHTTPRequest=function(e,t,n,s="application/json"){return new Promise((function(r,i){let o=new XMLHttpRequest;o.onreadystatechange=function(){if(4==this.readyState){let e=this.status;e<300?r(this.response):e>=300&&e<400?(i(new Error(`Request was redirected to ${this.responseURL}.`)),window.location=this.responseURL):(i(new Error(`Request returned a response status (${e})`)),document.write(this.response))}},o.open(e,t,!0),o.setRequestHeader("Content-Type",s),o.send(JSON.stringify(n))}))},e.processParams=function(){var e=new URL(document.location).searchParams;e.has("msg")&&alert(e.get("msg"))},e.getAccountInfo=function(){let e=localStorage.getItem("session_info");return null===e?e:JSON.parse(e)},e.updateAccountInfo=function(t){let n=e.getAccountInfo();null===n&&(n={}),Object.keys(t).forEach((e=>{n[e]=t[e]})),localStorage.setItem("session_info",JSON.stringify(n))},e.refreshMetadata=function(){let t=e.getAccountInfo();return null===t?Promise.resolve(null):new Promise((function(n,s){e.sendHTTPRequest("POST","/read-metadata",{userIDInApp:t.userIDInApp}).then((e=>{let t=JSON.parse(e).message,s=t.metadataDocs,r={};for(let e of t.minicards)r[e._id]={_id:e._id,title:e.title,tags:e.tags.trim().replace(/\s/g,", ")};localStorage.setItem("metadata",JSON.stringify(s)),localStorage.setItem("minicards",JSON.stringify(r)),n([s[0],r])})).catch((e=>{s(e)}))}))},AppUtilities=t})();
//# sourceMappingURL=AppUtilities.bundle.min.js.map