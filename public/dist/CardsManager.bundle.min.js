var CardsManager=function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=3)}([function(t,e){e.sendForm=function(t,r){return new Promise(function(n,o){let i=document.forms[t];if(i.checkValidity()){let t=i.elements,a={};for(let e=0;e<t.length;e++)"checkbox"==t[e].type?a[t[e].name]=t[e].checked:a[t[e].name]=t[e].value;delete a[""],e.sendHTTPRequest("POST",r,a).then(t=>{n(t)}).catch(t=>{o(t)})}else i.reportValidity(),o("Please fill in the form with valid inputs.")})},e.sendHTTPRequest=function(t,e,r,n="application/json"){return new Promise(function(o,i){let a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==this.readyState){let t=this.status;t<300?o(this.response):t>=300&&t<400?(i(new Error(`Request was redirected to ${this.responseURL}.`)),window.location=this.responseURL):(i(new Error(`Request returned a response status (${t})`)),document.write(this.response))}},a.open(t,e,!0),a.setRequestHeader("Content-Type",n),a.send(JSON.stringify(r))})},e.processParams=function(){var t=new URL(document.location).searchParams;t.has("msg")&&alert(t.get("msg"))},e.getAccountInfo=function(){let t=localStorage.getItem("session_info");return null===t?t:JSON.parse(t)},e.updateAccountInfo=function(t){let r=e.getAccountInfo();null===r&&(r={}),Object.keys(t).forEach(e=>{r[e]=t[e]}),localStorage.setItem("session_info",JSON.stringify(r))},e.refreshMetadata=function(){let t=e.getAccountInfo();return null===t?Promise.resolve(null):new Promise(function(r,n){e.sendHTTPRequest("POST","/read-metadata",{userIDInApp:t.userIDInApp}).then(t=>{let e=JSON.parse(t).message,n=e.metadataDocs,o={};for(let t of e.minicards)o[t._id]={_id:t._id,title:t.title,tags:t.tags.trim().replace(/\s/g,", ")};localStorage.setItem("metadata",JSON.stringify(n)),localStorage.setItem("minicards",JSON.stringify(o)),r([n[0],o])}).catch(t=>{n(t)})})}},,,function(t,e,r){"use strict";const n=r(4);var o=r(0).sendHTTPRequest;t.exports=function(t,e,r="/read-card",i={}){var a={},l=new n,u=null,c={};function f(t,e){return t.urgency<e.urgency?1:t.urgency>e.urgency?-1:t._id<e._id?1:t._id>e._id?-1:0}function s(t){return new Promise(function(n,i){let a=JSON.parse(localStorage.getItem(t));a?n(a):o("POST",r,{userIDInApp:e,cardID:t}).then(e=>{e=JSON.parse(e),localStorage.setItem(t,JSON.stringify(e.message[0])),n(e.message[0])}).catch(t=>{i(t)})})}return a.empty_card={title:"",description:"",tags:"",createdById:null,urgency:0,metadataIndex:null},a.initializeFromTags=function(e){return new Promise(function(r,o){null===e&&(e=Object.keys(t)),l=new n(f,!0),a.bst=l,u=null;let i=new Set([]);e.forEach(function(e){for(let r in t[e])!1===i.has(r)&&(a.insertCard(r,t[e][r].urgency),i.add(r))}),r()})},a.initializeFromMinicards=function(e,r=!1){return new Promise(function(o,i){l=new n(f,!0),a.bst=l,u=null;let c=new Set([]);if(e.forEach(t=>{c.add(t._id),a.insertCard(t._id,t.urgency)}),r){let r=new Set([]);e.forEach(t=>{t.tags.forEach(t=>{r.add(t)})}),r.forEach(function(e){for(let r in t[e])c.has(r)||(a.insertCard(r,t[e][r].urgency),c.add(r))})}o()})},a.initializeFromTrash=function(t){return new Promise(function(e,r){l=new n(f,!0),a.bst=l,u=null;let o=Object.keys(t);for(let e=0;e<o.length;e++)a.insertCard(o[e],t[o[e]]);e()})},a.cardKeys=function*(){let t=l.minNode();for(;t;)yield t.key,t=l.next(t);return"done"},a.fetchCard=function(t){return new Promise(function(e,r){(u=l.find(c[t]))?s(u.key._id).then(t=>{e(t)}).catch(t=>{r(t)}):e(null)})},a.next=function(){return new Promise(function(t,e){a.hasNext()?s((u=null===u?l.find(l.min()):l.next(u)).key._id).then(e=>{t(e)}).catch(t=>{e(t)}):t(null)})},a.hasNext=function(){return 0!==l.size&&(null===u||null!==l.next(u))},a.hasPrev=function(){return 0!==l.size&&null!==l.prev(u)},a.previous=function(){return new Promise(function(t,e){a.hasPrev()?s((u=l.prev(u)).key._id).then(e=>{t(e)}).catch(t=>{e(t)}):t(null)})},a.removeCard=function(t){if(u.key._id===t){let e=u.key;return u=a.hasPrev()?l.prev(u):a.hasNext()?l.next(u):null,delete c[t],l.remove(e),e._id}console.error(`${u.key._id} !== ${t}`)},a.insertCard=function(t,e){let r={_id:t,urgency:e};c[t]=r,l.insert(r)},a.updateCard=function(t){localStorage.removeItem(t._id),localStorage.setItem(t._id,JSON.stringify(t)),a.removeCard(t._id),a.insertCard(t._id,t.urgency),i[t._id]={_id:t._id,title:t.title,tags:t.tags.trim().replace(/\s/g,", ")}},a.quartiles=function(){let t=l._size;if(0==t)return[0,0,0,0];if(t<=4){let t=l.min().urgency;return[t,t,t,t]}return[l.at(Math.floor(3*t/4)).key.urgency,l.at(Math.floor(t/2)).key.urgency,l.at(Math.floor(t/4)).key.urgency,l.min().urgency]},a.saveCard=function(t,e){return new Promise(function(r,n){o("POST",e,t).then(t=>{(t=JSON.parse(t)).success?(a.updateCard(t.message),r(t.message)):n(t.message)}).catch(t=>{n(t)})})},a}},function(t,e,r){
/**
 * avl v1.4.4
 * Fast AVL tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 */
t.exports=function(){"use strict";function t(e){return e?1+Math.max(t(e.left),t(e.right)):0}function e(t,e){return t>e?1:t<e?-1:0}function r(t){var e=t.right;return t.right=e.left,e.left&&(e.left.parent=t),e.parent=t.parent,e.parent&&(e.parent.left===t?e.parent.left=e:e.parent.right=e),t.parent=e,e.left=t,t.balanceFactor+=1,e.balanceFactor<0&&(t.balanceFactor-=e.balanceFactor),e.balanceFactor+=1,t.balanceFactor>0&&(e.balanceFactor+=t.balanceFactor),e}function n(t){var e=t.left;return t.left=e.right,t.left&&(t.left.parent=t),e.parent=t.parent,e.parent&&(e.parent.left===t?e.parent.left=e:e.parent.right=e),t.parent=e,e.right=t,t.balanceFactor-=1,e.balanceFactor>0&&(t.balanceFactor-=e.balanceFactor),e.balanceFactor-=1,t.balanceFactor<0&&(e.balanceFactor+=t.balanceFactor),e}var o=function(t,r){void 0===r&&(r=!1),this._comparator=t||e,this._root=null,this._size=0,this._noDuplicates=!!r},i={size:{configurable:!0}};return o.prototype.destroy=function(){return this.clear()},o.prototype.clear=function(){return this._root=null,this._size=0,this},i.size.get=function(){return this._size},o.prototype.contains=function(t){if(this._root)for(var e=this._root,r=this._comparator;e;){var n=r(t,e.key);if(0===n)return!0;e=n<0?e.left:e.right}return!1},o.prototype.next=function(t){var e=t;if(e)if(e.right)for(e=e.right;e.left;)e=e.left;else for(e=t.parent;e&&e.right===t;)t=e,e=e.parent;return e},o.prototype.prev=function(t){var e=t;if(e)if(e.left)for(e=e.left;e.right;)e=e.right;else for(e=t.parent;e&&e.left===t;)t=e,e=e.parent;return e},o.prototype.forEach=function(t){for(var e=this._root,r=[],n=!1,o=0;!n;)e?(r.push(e),e=e.left):r.length>0?(t(e=r.pop(),o++),e=e.right):n=!0;return this},o.prototype.range=function(t,e,r,n){for(var o=[],i=this._comparator,a=this._root;0!==o.length||a;)if(a)o.push(a),a=a.left;else{if(i((a=o.pop()).key,e)>0)break;if(i(a.key,t)>=0&&r.call(n,a))return this;a=a.right}return this},o.prototype.keys=function(){for(var t=this._root,e=[],r=[],n=!1;!n;)t?(e.push(t),t=t.left):e.length>0?(t=e.pop(),r.push(t.key),t=t.right):n=!0;return r},o.prototype.values=function(){for(var t=this._root,e=[],r=[],n=!1;!n;)t?(e.push(t),t=t.left):e.length>0?(t=e.pop(),r.push(t.data),t=t.right):n=!0;return r},o.prototype.at=function(t){for(var e=this._root,r=[],n=!1,o=0;!n;)if(e)r.push(e),e=e.left;else if(r.length>0){if(e=r.pop(),o===t)return e;o++,e=e.right}else n=!0;return null},o.prototype.minNode=function(){var t=this._root;if(!t)return null;for(;t.left;)t=t.left;return t},o.prototype.maxNode=function(){var t=this._root;if(!t)return null;for(;t.right;)t=t.right;return t},o.prototype.min=function(){var t=this._root;if(!t)return null;for(;t.left;)t=t.left;return t.key},o.prototype.max=function(){var t=this._root;if(!t)return null;for(;t.right;)t=t.right;return t.key},o.prototype.isEmpty=function(){return!this._root},o.prototype.pop=function(){var t=this._root,e=null;if(t){for(;t.left;)t=t.left;e={key:t.key,data:t.data},this.remove(t.key)}return e},o.prototype.popMax=function(){var t=this._root,e=null;if(t){for(;t.right;)t=t.right;e={key:t.key,data:t.data},this.remove(t.key)}return e},o.prototype.find=function(t){for(var e,r=this._root,n=this._comparator;r;){if(0===(e=n(t,r.key)))return r;r=e<0?r.left:r.right}return null},o.prototype.insert=function(t,e){if(!this._root)return this._root={parent:null,left:null,right:null,balanceFactor:0,key:t,data:e},this._size++,this._root;var o=this._comparator,i=this._root,a=null,l=0;if(this._noDuplicates)for(;i;){if(a=i,0===(l=o(t,i.key)))return null;i=l<0?i.left:i.right}else for(;i;)a=i,i=(l=o(t,i.key))<=0?i.left:i.right;var u,c={left:null,right:null,balanceFactor:0,parent:a,key:t,data:e};for(l<=0?a.left=c:a.right=c;a&&((l=o(a.key,t))<0?a.balanceFactor-=1:a.balanceFactor+=1,0!==a.balanceFactor);){if(a.balanceFactor<-1){1===a.right.balanceFactor&&n(a.right),u=r(a),a===this._root&&(this._root=u);break}if(a.balanceFactor>1){-1===a.left.balanceFactor&&r(a.left),u=n(a),a===this._root&&(this._root=u);break}a=a.parent}return this._size++,c},o.prototype.remove=function(t){if(!this._root)return null;for(var e=this._root,o=this._comparator,i=0;e&&0!==(i=o(t,e.key));)e=i<0?e.left:e.right;if(!e)return null;var a,l,u=e.key;if(e.left){for(a=e.left;a.left||a.right;){for(;a.right;)a=a.right;e.key=a.key,e.data=a.data,a.left&&(e=a,a=a.left)}e.key=a.key,e.data=a.data,e=a}if(e.right){for(l=e.right;l.left||l.right;){for(;l.left;)l=l.left;e.key=l.key,e.data=l.data,l.right&&(e=l,l=l.right)}e.key=l.key,e.data=l.data,e=l}for(var c,f=e.parent,s=e;f&&(f.left===s?f.balanceFactor-=1:f.balanceFactor+=1,f.balanceFactor<-1?(1===f.right.balanceFactor&&n(f.right),c=r(f),f===this._root&&(this._root=c),f=c):f.balanceFactor>1&&(-1===f.left.balanceFactor&&r(f.left),c=n(f),f===this._root&&(this._root=c),f=c),-1!==f.balanceFactor&&1!==f.balanceFactor);)s=f,f=f.parent;return e.parent&&(e.parent.left===e?e.parent.left=null:e.parent.right=null),e===this._root&&(this._root=null),this._size--,u},o.prototype.load=function(t,e,r){if(void 0===t&&(t=[]),void 0===e&&(e=[]),0!==this._size)throw new Error("bulk-load: tree is not empty");var n=t.length;return r&&function t(e,r,n,o,i){if(!(n>=o)){for(var a=e[n+o>>1],l=n-1,u=o+1;;){do{l++}while(i(e[l],a)<0);do{u--}while(i(e[u],a)>0);if(l>=u)break;var c=e[l];e[l]=e[u],e[u]=c,c=r[l],r[l]=r[u],r[u]=c}t(e,r,n,u,i),t(e,r,u+1,o,i)}}(t,e,0,n-1,this._comparator),this._root=function t(e,r,n,o,i){var a=i-o;if(a>0){var l=o+Math.floor(a/2),u=r[l],c=n[l],f={key:u,data:c,parent:e};return f.left=t(f,r,n,o,l),f.right=t(f,r,n,l+1,i),f}return null}(null,t,e,0,n),function t(e){if(null===e)return 0;var r=t(e.left),n=t(e.right);return e.balanceFactor=r-n,Math.max(r,n)+1}(this._root),this._size=n,this},o.prototype.isBalanced=function(){return function e(r){if(null===r)return!0;var n=t(r.left),o=t(r.right);return!!(Math.abs(n-o)<=1&&e(r.left)&&e(r.right))}(this._root)},o.prototype.toString=function(t){return function(t,e){void 0===e&&(e=function(t){return t.key});var r=[];return function t(e,r,n,o,i){if(e){o(r+(n?"└── ":"├── ")+i(e)+"\n");var a=r+(n?"    ":"│   ");e.left&&t(e.left,a,!1,o,i),e.right&&t(e.right,a,!0,o,i)}}(t,"",!0,function(t){return r.push(t)},e),r.join("")}(this._root,t)},Object.defineProperties(o.prototype,i),o.default=o,o}()}]);