/*! For license information please see CardsManager.bundle.min.js.LICENSE.txt */
var CardsManager;(()=>{var t={183:function(t){t.exports=function(){"use strict";function t(t,r){void 0===r&&(r=function(t){return t.key});var n=[];return e(t,"",!0,(function(t){return n.push(t)}),r),n.join("")}function e(t,r,n,o,a){if(t){o(r+(n?"└── ":"├── ")+a(t)+"\n");var i=r+(n?"    ":"│   ");t.left&&e(t.left,i,!1,o,a),t.right&&e(t.right,i,!0,o,a)}}function r(t){if(null===t)return!0;var e=n(t.left),o=n(t.right);return!!(Math.abs(e-o)<=1&&r(t.left)&&r(t.right))}function n(t){return t?1+Math.max(n(t.left),n(t.right)):0}function o(t,e,r,n,a){var i=a-n;if(i>0){var l=n+Math.floor(i/2),c={key:e[l],data:r[l],parent:t};return c.left=o(c,e,r,n,l),c.right=o(c,e,r,l+1,a),c}return null}function a(t){if(null===t)return 0;var e=a(t.left),r=a(t.right);return t.balanceFactor=e-r,Math.max(e,r)+1}function i(t,e,r,n,o){if(!(r>=n)){for(var a=t[r+n>>1],l=r-1,c=n+1;;){do{l++}while(o(t[l],a)<0);do{c--}while(o(t[c],a)>0);if(l>=c)break;var s=t[l];t[l]=t[c],t[c]=s,s=e[l],e[l]=e[c],e[c]=s}i(t,e,r,c,o),i(t,e,c+1,n,o)}}function l(t,e){return t>e?1:t<e?-1:0}function c(t){var e=t.right;return t.right=e.left,e.left&&(e.left.parent=t),e.parent=t.parent,e.parent&&(e.parent.left===t?e.parent.left=e:e.parent.right=e),t.parent=e,e.left=t,t.balanceFactor+=1,e.balanceFactor<0&&(t.balanceFactor-=e.balanceFactor),e.balanceFactor+=1,t.balanceFactor>0&&(e.balanceFactor+=t.balanceFactor),e}function s(t){var e=t.left;return t.left=e.right,t.left&&(t.left.parent=t),e.parent=t.parent,e.parent&&(e.parent.left===t?e.parent.left=e:e.parent.right=e),t.parent=e,e.right=t,t.balanceFactor-=1,e.balanceFactor>0&&(t.balanceFactor-=e.balanceFactor),e.balanceFactor-=1,t.balanceFactor<0&&(e.balanceFactor+=t.balanceFactor),e}var u=function(t,e){void 0===e&&(e=!1),this._comparator=t||l,this._root=null,this._size=0,this._noDuplicates=!!e},f={size:{configurable:!0}};return u.prototype.destroy=function(){return this.clear()},u.prototype.clear=function(){return this._root=null,this._size=0,this},f.size.get=function(){return this._size},u.prototype.contains=function(t){if(this._root)for(var e=this._root,r=this._comparator;e;){var n=r(t,e.key);if(0===n)return!0;e=n<0?e.left:e.right}return!1},u.prototype.next=function(t){var e=t;if(e)if(e.right)for(e=e.right;e.left;)e=e.left;else for(e=t.parent;e&&e.right===t;)t=e,e=e.parent;return e},u.prototype.prev=function(t){var e=t;if(e)if(e.left)for(e=e.left;e.right;)e=e.right;else for(e=t.parent;e&&e.left===t;)t=e,e=e.parent;return e},u.prototype.forEach=function(t){for(var e=this._root,r=[],n=!1,o=0;!n;)e?(r.push(e),e=e.left):r.length>0?(t(e=r.pop(),o++),e=e.right):n=!0;return this},u.prototype.range=function(t,e,r,n){for(var o=[],a=this._comparator,i=this._root;0!==o.length||i;)if(i)o.push(i),i=i.left;else{if(a((i=o.pop()).key,e)>0)break;if(a(i.key,t)>=0&&r.call(n,i))return this;i=i.right}return this},u.prototype.keys=function(){for(var t=this._root,e=[],r=[],n=!1;!n;)t?(e.push(t),t=t.left):e.length>0?(t=e.pop(),r.push(t.key),t=t.right):n=!0;return r},u.prototype.values=function(){for(var t=this._root,e=[],r=[],n=!1;!n;)t?(e.push(t),t=t.left):e.length>0?(t=e.pop(),r.push(t.data),t=t.right):n=!0;return r},u.prototype.at=function(t){for(var e=this._root,r=[],n=!1,o=0;!n;)if(e)r.push(e),e=e.left;else if(r.length>0){if(e=r.pop(),o===t)return e;o++,e=e.right}else n=!0;return null},u.prototype.minNode=function(){var t=this._root;if(!t)return null;for(;t.left;)t=t.left;return t},u.prototype.maxNode=function(){var t=this._root;if(!t)return null;for(;t.right;)t=t.right;return t},u.prototype.min=function(){var t=this._root;if(!t)return null;for(;t.left;)t=t.left;return t.key},u.prototype.max=function(){var t=this._root;if(!t)return null;for(;t.right;)t=t.right;return t.key},u.prototype.isEmpty=function(){return!this._root},u.prototype.pop=function(){var t=this._root,e=null;if(t){for(;t.left;)t=t.left;e={key:t.key,data:t.data},this.remove(t.key)}return e},u.prototype.popMax=function(){var t=this._root,e=null;if(t){for(;t.right;)t=t.right;e={key:t.key,data:t.data},this.remove(t.key)}return e},u.prototype.find=function(t){for(var e,r=this._root,n=this._comparator;r;){if(0===(e=n(t,r.key)))return r;r=e<0?r.left:r.right}return null},u.prototype.insert=function(t,e){var r=this;if(!this._root)return this._root={parent:null,left:null,right:null,balanceFactor:0,key:t,data:e},this._size++,this._root;var n=this._comparator,o=this._root,a=null,i=0;if(this._noDuplicates)for(;o;){if(a=o,0===(i=n(t,o.key)))return null;o=i<0?o.left:o.right}else for(;o;)a=o,o=(i=n(t,o.key))<=0?o.left:o.right;var l,u={left:null,right:null,balanceFactor:0,parent:a,key:t,data:e};for(i<=0?a.left=u:a.right=u;a&&((i=n(a.key,t))<0?a.balanceFactor-=1:a.balanceFactor+=1,0!==a.balanceFactor);){if(a.balanceFactor<-1){1===a.right.balanceFactor&&s(a.right),l=c(a),a===r._root&&(r._root=l);break}if(a.balanceFactor>1){-1===a.left.balanceFactor&&c(a.left),l=s(a),a===r._root&&(r._root=l);break}a=a.parent}return this._size++,u},u.prototype.remove=function(t){var e=this;if(!this._root)return null;for(var r=this._root,n=this._comparator,o=0;r&&0!==(o=n(t,r.key));)r=o<0?r.left:r.right;if(!r)return null;var a,i,l=r.key;if(r.left){for(a=r.left;a.left||a.right;){for(;a.right;)a=a.right;r.key=a.key,r.data=a.data,a.left&&(r=a,a=a.left)}r.key=a.key,r.data=a.data,r=a}if(r.right){for(i=r.right;i.left||i.right;){for(;i.left;)i=i.left;r.key=i.key,r.data=i.data,i.right&&(r=i,i=i.right)}r.key=i.key,r.data=i.data,r=i}for(var u,f=r.parent,h=r;f&&(f.left===h?f.balanceFactor-=1:f.balanceFactor+=1,f.balanceFactor<-1?(1===f.right.balanceFactor&&s(f.right),u=c(f),f===e._root&&(e._root=u),f=u):f.balanceFactor>1&&(-1===f.left.balanceFactor&&c(f.left),u=s(f),f===e._root&&(e._root=u),f=u),-1!==f.balanceFactor&&1!==f.balanceFactor);)h=f,f=f.parent;return r.parent&&(r.parent.left===r?r.parent.left=null:r.parent.right=null),r===this._root&&(this._root=null),this._size--,l},u.prototype.load=function(t,e,r){if(void 0===t&&(t=[]),void 0===e&&(e=[]),0!==this._size)throw new Error("bulk-load: tree is not empty");var n=t.length;return r&&i(t,e,0,n-1,this._comparator),this._root=o(null,t,e,0,n),a(this._root),this._size=n,this},u.prototype.isBalanced=function(){return r(this._root)},u.prototype.toString=function(e){return t(this._root,e)},Object.defineProperties(u.prototype,f),u.default=u,u}()},912:(t,e)=>{"use strict";e.sendForm=function(t,r){return new Promise((function(n,o){let a=document.forms[t];if(a.checkValidity()){let t=a.elements,i={};for(let e=0;e<t.length;e++)"checkbox"==t[e].type?i[t[e].name]=t[e].checked:i[t[e].name]=t[e].value;delete i[""],e.sendHTTPRequest("POST",r,i).then((t=>{n(t)})).catch((t=>{o(t)}))}else a.reportValidity(),o("Please fill in the form with valid inputs.")}))},e.sendHTTPRequest=function(t,e,r,n="application/json"){return new Promise((function(o,a){let i=new XMLHttpRequest;i.onreadystatechange=function(){if(4==this.readyState){let t=this.status;t<300?o(this.response):t>=300&&t<400?(a(new Error(`Request was redirected to ${this.responseURL}.`)),window.location=this.responseURL):(a(new Error(`Request returned a response status (${t})`)),document.write(this.response))}},i.open(t,e,!0),i.setRequestHeader("Content-Type",n),i.send(JSON.stringify(r))}))},e.processParams=function(){var t=new URL(document.location).searchParams;t.has("msg")&&alert(t.get("msg"))},e.getAccountInfo=function(){let t=localStorage.getItem("session_info");return null===t?t:JSON.parse(t)},e.updateAccountInfo=function(t){let r=e.getAccountInfo();null===r&&(r={}),Object.keys(t).forEach((e=>{r[e]=t[e]})),localStorage.setItem("session_info",JSON.stringify(r))},e.refreshMetadata=function(){let t=e.getAccountInfo();return null===t?Promise.resolve(null):new Promise((function(r,n){e.sendHTTPRequest("POST","/read-metadata",{userIDInApp:t.userIDInApp}).then((t=>{let e=JSON.parse(t).message,n=e.metadataDocs,o={};for(let t of e.minicards)o[t._id]={_id:t._id,title:t.title,tags:t.tags.trim().replace(/\s/g,", ")};localStorage.setItem("metadata",JSON.stringify(n)),localStorage.setItem("minicards",JSON.stringify(o)),r([n[0],o])})).catch((t=>{n(t)}))}))}},238:(t,e,r)=>{"use strict";const n=r(183);var o=r(912).sendHTTPRequest;t.exports=function(t,e,r="/read-card",a={}){var i={},l=new n,c=null,s={};function u(t,e){return t.urgency<e.urgency?1:t.urgency>e.urgency?-1:t._id<e._id?1:t._id>e._id?-1:0}function f(t){return new Promise((function(n,a){let i=JSON.parse(localStorage.getItem(t));i?n(i):o("POST",r,{userIDInApp:e,cardID:t}).then((e=>{e=JSON.parse(e),localStorage.setItem(t,JSON.stringify(e.message[0])),n(e.message[0])})).catch((t=>{a(t)}))}))}return i.empty_card={title:"",description:"",tags:"",createdById:null,urgency:0,metadataIndex:null},i.initializeFromTags=function(e){return new Promise((function(r,o){null===e&&(e=Object.keys(t)),l=new n(u,!0),i.bst=l,c=null;let a=new Set([]);e.forEach((function(e){for(let r in t[e])!1===a.has(r)&&(i.insertCard(r,t[e][r].urgency),a.add(r))})),r()}))},i.initializeFromMinicards=function(e,r=!1){return new Promise((function(o,a){l=new n(u,!0),i.bst=l,c=null;let s=new Set([]);if(e.forEach((t=>{s.add(t._id),i.insertCard(t._id,t.urgency)})),r){let r=new Set([]);e.forEach((t=>{t.tags.forEach((t=>{r.add(t)}))})),r.forEach((function(e){for(let r in t[e])s.has(r)||(i.insertCard(r,t[e][r].urgency),s.add(r))}))}o()}))},i.initializeFromTrash=function(t){return new Promise((function(e,r){l=new n(u,!0),i.bst=l,c=null;let o=Object.keys(t);for(let e=0;e<o.length;e++)i.insertCard(o[e],t[o[e]]);e()}))},i.cardKeys=function*(){let t=l.minNode();for(;t;)yield t.key,t=l.next(t);return"done"},i.fetchCard=function(t){return new Promise((function(e,r){(c=l.find(s[t]))?f(c.key._id).then((t=>{e(t)})).catch((t=>{r(t)})):e(null)}))},i.next=function(){return new Promise((function(t,e){i.hasNext()?f((c=null===c?l.find(l.min()):l.next(c)).key._id).then((e=>{t(e)})).catch((t=>{e(t)})):t(null)}))},i.hasNext=function(){return 0!==l.size&&(null===c||null!==l.next(c))},i.hasPrev=function(){return 0!==l.size&&null!==l.prev(c)},i.previous=function(){return new Promise((function(t,e){i.hasPrev()?f((c=l.prev(c)).key._id).then((e=>{t(e)})).catch((t=>{e(t)})):t(null)}))},i.removeCard=function(t){c&&c.key._id===t&&(c=i.hasPrev()?l.prev(c):i.hasNext()?l.next(c):null);let e=s[t];return delete s[t],e&&l.remove(e),t},i.status=function(){if(c){let t=l.prev(c);t?f(t.key._id).then((t=>{console.log(`Previous: (${t.urgency}) ${t.title}`)})).catch((t=>{console.error(t)})):console.log("Previous: null"),f(c.key._id).then((t=>{console.log(`Current: (${t.urgency}) ${t.title}`)})).catch((t=>{console.error(t)})),t=l.next(c),t?f(t.key._id).then((t=>{console.log(`Next: (${t.urgency}) ${t.title}`)})).catch((t=>{console.error(t)})):console.log("Next: null")}else console.log("Current: null")},i.insertCard=function(t,e){let r={_id:t,urgency:e};s[t]=r,l.insert(r)},i.updateCard=function(t){localStorage.removeItem(t._id),localStorage.setItem(t._id,JSON.stringify(t)),a[t._id]={_id:t._id,title:t.title,tags:t.tags.trim().replace(/\s/g,", ")},s[t._id]&&i.removeCard(t._id),i.insertCard(t._id,t.urgency)},i.quartiles=function(){let t=l._size;if(0==t)return[0,0,0,0,0];if(t<=4){let t=l.min().urgency;return[t,t,t,t,t]}return[l.max().urgency,l.at(Math.floor(3*t/4)).key.urgency,l.at(Math.floor(t/2)).key.urgency,l.at(Math.floor(t/4)).key.urgency,l.min().urgency]},i.saveCard=function(t,e){return new Promise((function(r,n){o("POST",e,t).then((t=>{(t=JSON.parse(t)).success?(i.updateCard(t.message),r(t.message)):n(t.message)})).catch((t=>{n(t)}))}))},i}}},e={},r=function r(n){var o=e[n];if(void 0!==o)return o.exports;var a=e[n]={exports:{}};return t[n].call(a.exports,a,a.exports,r),a.exports}(238);CardsManager=r})();
//# sourceMappingURL=CardsManager.bundle.min.js.map